# Migration Guide: v0.2.0 → v0.2.1

## Overview
Version 0.2.1 is a **patch release** that fixes 5 critical P0 bugs identified in v0.2.0. There are **no breaking changes** – existing workflows continue to work without modification.

## What's Fixed
1. **Index-Part-Bug**: `split_conversations_by_size.py` now generates correct `index.csv` entries when conversations span multiple parts
2. **Feedback Form**: Backend API accepts string ratings (frontend sends `"5"` not `5`)
3. **Rating Scale**: GitHub Issues now show `/5` scale instead of incorrect `/10`
4. **Helpful Field**: Feedback submissions now include the `helpful` field value
5. **Frontend Stability**: Fixed `hitNav` undefined reference and NaN timestamp edge cases

## Migration Steps

### For End Users (Browser-Only Usage)
**No action required.** Simply load the new version:

1. Download `GPT_Export_Manager_v0.2.1/`
2. Open `GPT-Export-Aufbereiter/chat_aufbereiten.html` in your browser
3. Your existing part files and index.csv from v0.2.0 work unchanged

### For Users with Split Conversations (Optional)
If you previously ran `split_conversations_by_size.py` with v0.2.0 and experienced the index-part bug:

```powershell
# Re-split your conversations.json to regenerate correct index.csv
python split_conversations_by_size.py conversations.json output_dir --max-bytes 50000000
```

**When to re-split:**
- ✅ If you noticed search results pointing to wrong conversation parts
- ✅ If your index.csv has incorrect `part_file` values
- ❌ Skip if everything works correctly (many splits were unaffected)

### For Developers/Contributors
1. **Pull latest code**: `git checkout GPT_Export_Manager_v0.2.1/`
2. **Run tests** (new in v0.2.1):
   ```powershell
   pytest GPT_Export_Manager_v0.2.1/test_split_conversations_by_size.py -v
   ```
3. **Review changes**: See [CHANGELOG.md](../../CHANGELOG.md#021--2025-01-15-p0-bugfix-release)

### For Vercel Deployments
Update environment variables (no code changes needed):

```bash
# Existing variables remain unchanged
GH_TOKEN=your_github_token
GH_REPO=owner/repo

# Deploy new version
vercel --prod
```

Feedback API now handles string ratings automatically – no configuration changes required.

## Testing Checklist
After upgrading, verify these workflows:

- [ ] **Split Large Exports**: Run `split_conversations_by_size.py` on a >100MB `conversations.json`
- [ ] **Search & Navigate**: Search term in viewer, click through results with ◀ ▶ buttons
- [ ] **Feedback Submission**: Submit feedback with ratings (should accept without errors)
- [ ] **Index Correctness**: Open `index.csv` – `part_file` column matches actual conversation locations
- [ ] **Fallback File Picker**: Test in Firefox/Safari (browsers without `showOpenFilePicker` support)

## Rollback Procedure
If you encounter issues with v0.2.1:

1. **Keep your data**: All `.json` part files and `.csv` files are forward/backward compatible
2. **Switch HTML file**: Return to `GPT_Export_Manager_v0.2.0/GPT-Export-Aufbereiter/chat_aufbereiten.html`
3. **Python script**: Copy `split_conversations_by_size.py` from v0.2.0 root directory
4. **Report issue**: Open GitHub Issue with error details

**Note:** Feedback API changes are backend-only. Switching HTML files automatically uses the deployed API version.

## Breaking Changes
**None.** This release maintains full backward compatibility.

## FAQ

### Do I need to re-process my conversations?
**Only if** you experienced the index-part bug (wrong search results). Most users can upgrade without re-processing.

### Will old `index.csv` files work?
**Yes**, unless they contain the index-part bug. The viewer format is unchanged.

### Can I mix v0.2.0 and v0.2.1 files?
**Yes**. Part files (`.json`) and index files (`.csv`) are fully compatible across versions. Only the viewer HTML and Python script differ.

### What about the feedback API?
The API is backward compatible – v0.2.0 frontends work with v0.2.1 API. However, v0.2.0 API may reject some valid v0.2.1 submissions (string ratings).

## Support
- **GitHub Issues**: Report bugs at [repository]/issues
- **Documentation**: See main README.md for usage guides
- **Changelog**: Full release notes in [CHANGELOG.md](../../CHANGELOG.md)

---

**Version:** 0.2.1  
**Release Date:** 2025-01-15  
**Type:** Patch Release (P0 Bugfixes)  
**Breaking Changes:** None
